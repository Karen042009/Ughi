<!DOCTYPE html>
<html lang="hy">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ughi Admin</title>
    <!-- NOTE: Removed leaflet.css as it's not used here -->
    <!-- ’Ä’´’¥’∂’°’Ø’°’∂ ’∏’≥’•÷Ä’® -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <!-- ‘±’§’¥’´’∂’´ ’∞’°’ø’∏÷Ç’Ø ’∏’≥’•÷Ä’® -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/admin.css') }}"
    />
  </head>
  <body>
    <!-- Drag & Drop Tooltip -->
    <div
      id="drag-tooltip"
      class="drag-tooltip hidden"
      role="status"
      aria-live="polite"
    >
      <strong>üí° ’Ä’∏÷Ç’∑’∏÷Ç’¥:</strong> ’ç’•’≤’¥’•÷Ñ ÷á ’∫’°’∞’•÷Ñ ’æ’°’µ÷Ä’•÷Ä’® 300’¥’Ω, ’°’∫’° ÷Ñ’°’∑’•÷Ñ
      ’æ’•÷Ä÷á-’∂’•÷Ä÷Ñ÷á’ù ’§’°’Ω’°’æ’∏÷Ä’∏÷Ç’©’µ’∏÷Ç’∂’® ÷É’∏’≠’•’¨’∏÷Ç ’∞’°’¥’°÷Ä
    </div>

    <header>
      <div class="header-content">
        <h1>Ughi Admin</h1>
        <p>‘ø’°’º’°’æ’°÷Ä’•÷Ñ ’æ’°’µ÷Ä’•÷Ä’∂ ’∏÷Ç ’Ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä’®</p>
      </div>
      <div class="header-actions">
        <span class="user-info"
          >’ï’£’ø’°’ø’•÷Ä’ù {{ session.username }} ({{ session.role }})</span
        >
        <a href="/admin/logout" class="btn btn-danger">‘µ’¨÷Ñ</a>
      </div>
      <a href="/" class="admin-back">‚¨Ö ’é’•÷Ä’°’§’°÷Ä’± ’£’¨’≠’°’æ’∏÷Ä ’ß’ª</a>
    </header>

    <!-- Statistics Dashboard -->
    <section class="admin-section stats-dashboard">
      <h2>’é’´’≥’°’Ø’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="total-businesses">-</div>
          <div class="stat-label">‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’æ’°’µ÷Ä’•÷Ä</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="total-reviews">-</div>
          <div class="stat-label">‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ’Ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="total-users">-</div>
          <div class="stat-label">‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä ÷Ö’£’ø’°’ø’•÷Ä’•÷Ä</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="avg-rating">-</div>
          <div class="stat-label">’Ñ’´’ª’´’∂ ’£’∂’°’∞’°’ø’°’Ø’°’∂</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="recent-reviews">-</div>
          <div class="stat-label">’é’•÷Ä’ª’´’∂ 7 ÷Ö÷Ä’æ’° ’Ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä</div>
        </div>
      </div>
      <div class="stats-charts">
        <div class="chart-container">
          <h3>‘≥’∂’°’∞’°’ø’°’Ø’°’∂’∂’•÷Ä’´ ’¢’°’∑’≠’∏÷Ç’¥</h3>
          <div id="rating-chart" class="chart"></div>
        </div>
        <div class="chart-container">
          <h3>’é’°’µ÷Ä’•÷Ä’´ ’ø’•’Ω’°’Ø’∂’•÷Ä</h3>
          <div id="type-chart" class="chart"></div>
        </div>
      </div>
    </section>

    <div class="admin-container">
      <!-- User Management Section -->
      <section class="admin-section">
        <div class="admin-toolbar">
          <h2>’ï’£’ø’°’ø’•÷Ä’•÷Ä’´ ’Ø’°’º’°’æ’°÷Ä’∏÷Ç’¥</h2>
          <div class="toolbar-actions">
            <button id="add-user-btn" class="btn btn-primary">
              ‘±’æ’•’¨’°÷Å’∂’•’¨ ÷Ö’£’ø’°’ø’•÷Ä
            </button>
            <button id="bulk-delete-users-btn" class="btn btn-danger" disabled>
              ‘∂’°’∂’£’æ’°’Æ’°’µ’´’∂ ’ª’∂’ª’∏÷Ç’¥
            </button>
          </div>
        </div>
        <ul id="admin-users-list" class="admin-list">
          <!-- Users will be loaded here via JavaScript -->
        </ul>
      </section>

      <section class="admin-section">
        <h2>‘±’æ’•’¨’°÷Å’∂’•’¨ ’∂’∏÷Ä ’æ’°’µ÷Ä</h2>
        <form id="add-business-form" class="admin-form">
          <div class="form-row">
            <label for="biz-name">‘±’∂’æ’°’∂’∏÷Ç’¥</label>
            <input id="biz-name" name="name" type="text" required />
          </div>
          <div class="form-row">
            <label for="biz-type">’è’•’Ω’°’Ø</label>
            <input
              id="biz-type"
              name="type"
              type="text"
              placeholder="÷Ö÷Ä.’ù Hotel, Restaurant..."
              required
            />
          </div>
          <div class="form-row grid-2">
            <div>
              <label for="biz-lat">‘º’°’µ’∂’∏÷Ç’©’µ’∏÷Ç’∂ (Latitude)</label>
              <input
                id="biz-lat"
                name="latitude"
                type="number"
                step="any"
                required
              />
            </div>
            <div>
              <label for="biz-lng">‘µ÷Ä’Ø’°’µ’∂’∏÷Ç’©’µ’∏÷Ç’∂ (Longitude)</label>
              <input
                id="biz-lng"
                name="longitude"
                type="number"
                step="any"
                required
              />
            </div>
          </div>
          <button type="submit" class="btn btn-success">‘±’æ’•’¨’°÷Å’∂’•’¨</button>
        </form>
      </section>

      <section class="admin-section">
        <div class="admin-toolbar">
          <h2>’é’°’µ÷Ä’•÷Ä <span id="biz-count" class="badge">0</span></h2>
          <div class="toolbar-actions">
            <input
              id="admin-search"
              type="text"
              placeholder="’à÷Ä’∏’∂’•’¨ ’æ’°’µ÷Ä..."
              aria-label="’à÷Ä’∏’∂’•’¨ ’æ’°’µ÷Ä"
            />
            <button id="bulk-delete-btn" class="btn btn-danger" disabled>
              ‘∂’°’∂’£’æ’°’Æ’°’µ’´’∂ ’ª’∂’ª’∏÷Ç’¥
            </button>
            <button id="export-btn" class="btn btn-secondary">Export</button>
          </div>
        </div>
        <ul id="admin-business-list" class="admin-list">
          <!-- ’é’°’µ÷Ä’•÷Ä’® ’Ø÷Å’∏÷Ç÷Å’°’§÷Ä’æ’•’∂ ’°’µ’Ω’ø’•’≤ JS-’´ ’¥’´’ª’∏÷Å’∏’æ -->
        </ul>
      </section>

      <section class="admin-section">
        <div class="admin-toolbar">
          <h2>‘ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä</h2>
          <div class="toolbar-actions">
            <button
              id="bulk-delete-reviews-btn"
              class="btn btn-danger"
              disabled
            >
              ‘∂’°’∂’£’æ’°’Æ’°’µ’´’∂ ’ª’∂’ª’∏÷Ç’¥
            </button>
          </div>
        </div>
        <div
          id="selected-business-label"
          class="muted"
          style="margin-bottom: 16px"
        >
          ‘∏’∂’ø÷Ä’•÷Ñ ’æ’°’µ÷Ä’ù ’Ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä’® ’ø’•’Ω’∂’•’¨’∏÷Ç ’∞’°’¥’°÷Ä
        </div>
        <div id="reviews-admin">
          <form id="add-review-form" class="admin-form hidden">
            <!-- ’ç’Ø’¶’¢’∂’°’∫’•’Ω ’©’°÷Ñ’∂’æ’°’Æ -->
            <input type="hidden" id="admin-business-id" />
            <div class="form-row">
              <label for="admin-comment">‘±’æ’•’¨’°÷Å’∂’•’¨ ’∂’∏÷Ä ’¥’•’Ø’∂’°’¢’°’∂’∏÷Ç’©’µ’∏÷Ç’∂</label>
              <textarea id="admin-comment" rows="3" required></textarea>
            </div>
            <div class="form-row grid-3">
              <div>
                <label for="admin-rating">‘≥’∂’°’∞’°’ø’°’Ø’°’∂</label>
                <select id="admin-rating">
                  <option value="5">5 ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</option>
                  <option value="4">4 ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</option>
                  <option value="3">3 ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ</option>
                  <option value="2">2 ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ</option>
                  <option value="1">1 ‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ</option>
                </select>
              </div>
              <div>
                <label for="admin-author">’Ä’•’≤’´’∂’°’Ø</label>
                <select id="admin-author">
                  <option value="Tourist">’á÷Ä’ª’°’∑÷Ä’ª’´’Ø</option>
                  <option value="Employee">‘±’∑’≠’°’ø’°’Ø’´÷Å</option>
                </select>
              </div>
              <div>
                <button type="submit" class="btn btn-primary">‘±’æ’•’¨’°÷Å’∂’•’¨</button>
              </div>
            </div>
          </form>
          <ul
            id="admin-reviews-list"
            class="admin-list"
            style="margin-top: 16px"
          >
            <!-- ‘ø’°÷Ä’Æ’´÷Ñ’∂’•÷Ä’® ’Ø÷Å’∏÷Ç÷Å’°’§÷Ä’æ’•’∂ ’°’µ’Ω’ø’•’≤ -->
          </ul>
        </div>
      </section>
    </div>

    <!-- Add User Modal -->
    <div id="add-user-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>‘±’æ’•’¨’°÷Å’∂’•’¨ ’∂’∏÷Ä ÷Ö’£’ø’°’ø’•÷Ä</h3>
          <button class="modal-close">&times;</button>
        </div>
        <form id="add-user-form" class="admin-form">
          <div class="form-row">
            <label for="new-username">’ï’£’ø’°’∂’∏÷Ç’∂</label>
            <input id="new-username" name="username" type="text" required />
          </div>
          <div class="form-row">
            <label for="new-email">‘∑’¨. ÷É’∏’Ω’ø</label>
            <input id="new-email" name="email" type="email" required />
          </div>
          <div class="form-row">
            <label for="new-password">‘≥’°’≤’ø’∂’°’¢’°’º</label>
            <input id="new-password" name="password" type="password" required />
          </div>
          <div class="form-row">
            <label for="new-role">‘¥’•÷Ä</label>
            <select id="new-role" name="role">
              <option value="admin">Admin</option>
              <option value="moderator">Moderator</option>
              <option value="user">User</option>
            </select>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeAddUserModal()"
            >
              ’â’•’≤’°÷Ä’Ø’•’¨
            </button>
            <button type="submit" class="btn btn-primary">‘±’æ’•’¨’°÷Å’∂’•’¨</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit User Modal -->
    <div id="edit-user-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>‘Ω’¥’¢’°’£÷Ä’•’¨ ÷Ö’£’ø’°’ø’•÷Ä</h3>
          <button class="modal-close">&times;</button>
        </div>
        <form id="edit-user-form" class="admin-form">
          <input type="hidden" id="edit-user-id" />
          <div class="form-row">
            <label for="edit-username">’ï’£’ø’°’∂’∏÷Ç’∂</label>
            <input id="edit-username" name="username" type="text" required />
          </div>
          <div class="form-row">
            <label for="edit-email">‘∑’¨. ÷É’∏’Ω’ø</label>
            <input id="edit-email" name="email" type="email" required />
          </div>
          <div class="form-row">
            <label for="edit-password"
              >‘≥’°’≤’ø’∂’°’¢’°’º (’§’°’ø’°÷Ä’Ø ’©’∏’≤’∂’•’¨’ù ’π÷É’∏’≠’•’¨’∏÷Ç ’∞’°’¥’°÷Ä)</label
            >
            <input id="edit-password" name="password" type="password" />
          </div>
          <div class="form-row">
            <label for="edit-role">‘¥’•÷Ä</label>
            <select id="edit-role" name="role">
              <option value="admin">Admin</option>
              <option value="moderator">Moderator</option>
              <option value="user">User</option>
            </select>
          </div>
          <div class="form-row">
            <label class="checkbox-label">
              <input type="checkbox" id="edit-user-active" name="is_active" />
              ‘±’Ø’ø’´’æ ÷Ö’£’ø’°’ø’•÷Ä
            </label>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeEditUserModal()"
            >
              ’â’•’≤’°÷Ä’Ø’•’¨
            </button>
            <button type="submit" class="btn btn-primary">’ä’°’∞’∫’°’∂’•’¨</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit Business Modal -->
    <div id="edit-business-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>‘Ω’¥’¢’°’£÷Ä’•’¨ ’æ’°’µ÷Ä</h3>
          <button class="modal-close">&times;</button>
        </div>
        <form id="edit-business-form" class="admin-form">
          <input type="hidden" id="edit-business-id" />
          <div class="form-row">
            <label for="edit-biz-name">‘±’∂’æ’°’∂’∏÷Ç’¥</label>
            <input id="edit-biz-name" name="name" type="text" required />
          </div>
          <div class="form-row">
            <label for="edit-biz-type">’è’•’Ω’°’Ø</label>
            <input id="edit-biz-type" name="type" type="text" required />
          </div>
          <div class="form-row grid-2">
            <div>
              <label for="edit-biz-lat">‘º’°’µ’∂’∏÷Ç’©’µ’∏÷Ç’∂</label>
              <input
                id="edit-biz-lat"
                name="latitude"
                type="number"
                step="any"
                required
              />
            </div>
            <div>
              <label for="edit-biz-lng">‘µ÷Ä’Ø’°’µ’∂’∏÷Ç’©’µ’∏÷Ç’∂</label>
              <input
                id="edit-biz-lng"
                name="longitude"
                type="number"
                step="any"
                required
              />
            </div>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeEditModal()"
            >
              ’â’•’≤’°÷Ä’Ø’•’¨
            </button>
            <button type="submit" class="btn btn-primary">’ä’°’∞’∫’°’∂’•’¨</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Edit Review Modal -->
    <div id="edit-review-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>‘Ω’¥’¢’°’£÷Ä’•’¨ ’Ø’°÷Ä’Æ’´÷Ñ</h3>
          <button class="modal-close">&times;</button>
        </div>
        <form id="edit-review-form" class="admin-form">
          <input type="hidden" id="edit-review-id" />
          <div class="form-row">
            <label for="edit-review-rating">‘≥’∂’°’∞’°’ø’°’Ø’°’∂</label>
            <select id="edit-review-rating" name="rating">
              <option value="5">5 ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</option>
              <option value="4">4 ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</option>
              <option value="3">3 ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ</option>
              <option value="2">2 ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ</option>
              <option value="1">1 ‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ</option>
            </select>
          </div>
          <div class="form-row">
            <label for="edit-review-comment">’Ñ’•’Ø’∂’°’¢’°’∂’∏÷Ç’©’µ’∏÷Ç’∂</label>
            <textarea
              id="edit-review-comment"
              name="comment"
              rows="3"
              required
            ></textarea>
          </div>
          <div class="form-row">
            <label for="edit-review-author">’Ä’•’≤’´’∂’°’Ø</label>
            <select id="edit-review-author" name="author_type">
              <option value="Tourist">’á÷Ä’ª’°’∑÷Ä’ª’´’Ø</option>
              <option value="Employee">‘±’∑’≠’°’ø’°’Ø’´÷Å</option>
            </select>
          </div>
          <div class="form-actions">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeReviewModal()"
            >
              ’â’•’≤’°÷Ä’Ø’•’¨
            </button>
            <button type="submit" class="btn btn-primary">’ä’°’∞’∫’°’∂’•’¨</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Floating Up/Down buttons -->
    <button id="scroll-top" class="fab fab-up" aria-label="’é’•÷Ä÷á">‚Üë</button>
    <button id="scroll-bottom" class="fab fab-down" aria-label="’Ü’•÷Ä÷Ñ÷á">
      ‚Üì
    </button>

    <div id="toast" class="toast hidden" aria-live="polite"></div>

    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
  </body>
</html>
